---
title: "Análise da base RAIS"
description: |
  Esta análise teve como objetivo analisar os salários na base da RAIS.
  
author:
  - name: Alan Santos

date: "`r format(Sys.time(), '%d %b, %Y')`"
output:
  distill::distill_article:
    self_contained: false
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

Neste relatório estamos interessados em responder a pergunta:

"Quanto ganha um cientista de dados?"

Para isso, vamos utilizar a base da RAIS anonimazada

# Acessando os dados da RAIS

Vamos utilizar o [datalake da iniciativa base dos dados](https://basedosdados.org).

```{r message=FALSE, warning=FALSE}
library(bigrquery)
library(tidyverse)
```


Segue abaixo,  o código que carrega as primeiras 5 linhas da tabela de microdados

```{r}
# ler um arquivo
#tab_normal <- read.csv("https://raw.githubusercontent.com/curso-r/main-r4ds-1/master/dad#os/imdb.csv")

#head(tab_normal, n = 5)

```


```{r, cache=TRUE}
# usando SGDB (máquina - processa e envia os dados)
conexao <- dbConnect(
        bigquery(), 
        project = "basedosdados",
        dataset = "br_me_rais",
        billing = "semanads-337000"
)

# conexao simples entre o r e a tabela do google(robo)

bigrquery::bq_auth("alanferreirasantos37@gmail.com")

base <- tbl(conexao, "microdados_vinculos") %>% 
        select(everything()) %>% 
        head(5) %>% 
        collect()

base
```

A base de dados que queremos analisar aqui é a base de pessoas que (pontencialmente) trabalham com ciência de dados. Existe um código brasileiro de ocupações (CBO), que 
tem um cadastro de todas as ocupações formais do brasil. Vamos pegar alguns códigos que são relacionados a ciência de dados e filtrar a base da RAIS para obter os dados

Pergunta principal da pesquisa: 

> quanto uma pessoa que trabalha com ciência de dados ganha?

```{r}

codigos_cbo <- c(
        "252515", "252525" , "211110",
        # pesquisa/cientista
        "211205", "411035",
        "211210", "131120", "211215"
        # ocupaçoes estatisticas
)


microdados_tbl <- tbl(conexao, "microdados_vinculos") %>% 
        select(everything()) %>% 
        filter(
                ano >= 2013 & cbo_2002 %in% c(codigos_cbo)
        ) %>% 
        head(n = 5000)

tabela_microdados_vinculos <- collect(microdados_tbl)
```

